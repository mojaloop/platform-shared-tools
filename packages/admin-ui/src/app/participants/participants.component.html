<div class="row mb-2">
  <div class="col">
    <h3>Participants</h3>
  </div>
  <div class="col text-right">
    <button class="btn btn-success btn-labeled" routerLink="/participants/new">
      <span class="btn-label"><i class="bi bi-plus-lg"></i></span>Create Participant
    </button>
  </div>
</div>

<!--filter-->
<div class="filterbox">
  <form>
    <table class="table">
      <tr class="form-row">
		  <div class="form-group col-md-4">
			  <label for="filterParticipantName">Name:</label>
			  <input class="form-control" type="text" id="filterParticipantName" />
		  </div>

		  <div class="form-group col-md-2">
          <label for="filterParticipantId">ID:</label>
          <input class="form-control" type="text" id="filterParticipantId" />
        </div>


        <div class="form-group col-md-2">
          <label for="filterParticipantState">State:</label>
					<select class="form-control" id="filterParticipantState">
						<option value="{{ALL_STR_ID}}">(All)</option>
						<option value="{{item}}" *ngFor="let item of (keywordParticipantState | async)">{{item}}</option>
					</select>
        </div>

		<div class="form-group col-md-2"></div> <!-- spacer-->

		  <div class="form-group col-md-2">
          <label for="filterBtn">&nbsp;</label>
          <button
            type="submit"
            class="form-control btn btn-primary"
            id="filterBtn"
            (click)="search()">
			  Search&nbsp;&nbsp;<i class="bi bi-search"></i>
          </button>
        </div>
      </tr>
    </table>
  </form>
</div>

<div>
  <table class="table">
    <thead class="thead-light">
      <tr>
        <th scope="col">ID</th>
        <th scope="col">Name</th>
        <th scope="col">State</th>
        <th scope="col"># Accounts</th>
        <th scope="col">Created</th>
        <th scope="col">Last action</th>
      </tr>
    </thead>
    <tbody>
      <tr *ngFor="let item of (participants | async)">
        <td>{{ item.id }}</td>
        <td>
          <a routerLink="/participants/{{ item.id }}">{{ item.name }}</a>
        </td>
        <!--      <td>{{item.isActive ? "Active" : "Inactive"}} / {{item.approved ? "Approved" : "Not Approved" }}</td>-->
        <td>{{ item.approved ? "Approved" : "Not Approved" }}</td>
        <td>{{ item.participantAccounts.length }}</td>
        <td class="text-secondary">
          By <span class="text-dark">{{ item.createdBy }}</span> at
          <span class="text-dark">{{ item.createdDate | date : "short" }}</span>
        </td>
        <td class="text-secondary">
          <span class="text-dark">{{ item.changeLog[0].changeType }}</span> at
          <span class="text-dark">{{
            item.changeLog[0].timestamp | date : "short"
          }}</span>
        </td>
      </tr>
    </tbody>
  </table>
</div>

<div></div>

<!--pagination
TODO: put in component
-->
<hr>
<nav aria-label="Page navigation"  *ngIf="paginateResult | async; let paginateObj">
	<ul class="pagination justify-content-end">
		<li class="page-item" [ngClass]="{'disabled' : paginateObj.prev == null}">
			<a class="page-link" aria-label="Previous" (click)="search(paginateObj.prev ? paginateObj.prev-1 : 0)">
				<span aria-hidden="true">&laquo;</span>
				<span class="sr-only">Previous</span>
			</a>
		</li>

		<ng-container *ngFor="let item of paginateObj.items">
			<li class="page-item" *ngIf="item != null" [ngClass]="{'active' : item === paginateObj.current}">
				<a class="page-link" (click)="search(item-1)" >{{item}}
					<span class="sr-only" *ngIf="item === paginateObj.current">(current)</span>
				</a>
			</li>
			<li class="page-item disabled" *ngIf="item == null">
				<a class="page-link disabled" *ngIf="!item" >...</a>
			</li>
		</ng-container>

		<li class="page-item"  [ngClass]="{'disabled' : paginateObj.next == null}">
			<a class="page-link" aria-label="Next" (click)="search(paginateObj.next ? paginateObj.next-1 : 0)">
				<span aria-hidden="true">&raquo;</span>
				<span class="sr-only">Next</span>
			</a>
		</li>
	</ul>
</nav>

